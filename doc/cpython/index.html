<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `cpython` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, cpython">

    <title>cpython - Rust</title>

    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        
        <p class='location'></p><script>window.sidebarCurrent = {name: 'cpython', ty: 'mod', relpath: '../'};</script>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>cpython</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/cpython/lib.rs.html#19-301' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>Rust bindings to the Python interpreter.</p>

<h1 id="ownership-and-lifetimes" class='section-header'><a
                           href="#ownership-and-lifetimes">Ownership and Lifetimes</a></h1>
<p>In Python, all objects are implicitly reference counted.
In rust, we will use the <code>PyObject</code> type to represent a reference to a Python object.</p>

<p>Because all Python objects potentially have multiple owners, the concept
concept of rust mutability does not apply to Python objects.
As a result, this API will allow mutating Python objects even if they are not stored
in a mutable rust variable.</p>

<p>The Python interpreter uses a global interpreter lock (GIL)
to ensure thread-safety.
This API uses the lifetime parameter <code>PyObject&lt;&#39;p&gt;</code> to ensure that Python objects cannot
be accessed without holding the GIL.
Throughout this library, the lifetime <code>&#39;p</code> always refers to the lifetime of the Python interpreter.</p>

<p>When accessing existing objects, the lifetime on <code>PyObject&lt;&#39;p&gt;</code> is sufficient to ensure that the GIL
is held by the current code. But we also need to ensure that the GIL is held when creating new objects.
For this purpose, this library uses the marker type <code>Python&lt;&#39;p&gt;</code>,
which acts like a reference to the whole Python interpreter.</p>

<p>You can obtain a <code>Python&lt;&#39;p&gt;</code> instance by acquiring the GIL, or by calling <code>Python()</code>
on any existing Python object.</p>

<h1 id="error-handling" class='section-header'><a
                           href="#error-handling">Error Handling</a></h1>
<p>The vast majority of operations in this library will return <code>PyResult&lt;&#39;p, ...&gt;</code>.
This is an alias for the type <code>Result&lt;..., PyErr&lt;&#39;p&gt;&gt;</code>.</p>

<p>A <code>PyErr</code> represents a Python exception. Errors within the rust-cpython library are
also exposed as Python exceptions.</p>

<h1 id="example" class='section-header'><a
                           href="#example">Example</a></h1><pre class='rust rust-example-rendered'>
<span class='kw'>extern</span> <span class='kw'>crate</span> <span class='ident'>cpython</span>;

<span class='kw'>use</span> <span class='ident'>cpython</span>::{<span class='ident'>PythonObject</span>, <span class='ident'>Python</span>};
<span class='kw'>use</span> <span class='ident'>cpython</span>::<span class='ident'>ObjectProtocol</span>; <span class='comment'>//for call method</span>

<span class='kw'>fn</span> <span class='ident'>main</span>() {
    <span class='kw'>let</span> <span class='ident'>gil</span> <span class='op'>=</span> <span class='ident'>Python</span>::<span class='ident'>acquire_gil</span>();
    <span class='kw'>let</span> <span class='ident'>py</span> <span class='op'>=</span> <span class='ident'>gil</span>.<span class='ident'>python</span>();

    <span class='kw'>let</span> <span class='ident'>sys</span> <span class='op'>=</span> <span class='ident'>py</span>.<span class='ident'>import</span>(<span class='string'>&quot;sys&quot;</span>).<span class='ident'>unwrap</span>();
    <span class='kw'>let</span> <span class='ident'>version</span>: <span class='ident'>String</span> <span class='op'>=</span> <span class='ident'>sys</span>.<span class='ident'>get</span>(<span class='string'>&quot;version&quot;</span>).<span class='ident'>unwrap</span>().<span class='ident'>extract</span>().<span class='ident'>unwrap</span>();

    <span class='kw'>let</span> <span class='ident'>os</span> <span class='op'>=</span> <span class='ident'>py</span>.<span class='ident'>import</span>(<span class='string'>&quot;os&quot;</span>).<span class='ident'>unwrap</span>();
    <span class='kw'>let</span> <span class='ident'>getenv</span> <span class='op'>=</span> <span class='ident'>os</span>.<span class='ident'>get</span>(<span class='string'>&quot;getenv&quot;</span>).<span class='ident'>unwrap</span>();
    <span class='kw'>let</span> <span class='ident'>user</span>: <span class='ident'>String</span> <span class='op'>=</span> <span class='ident'>getenv</span>.<span class='ident'>call</span>((<span class='string'>&quot;USER&quot;</span>,), <span class='prelude-val'>None</span>).<span class='ident'>unwrap</span>().<span class='ident'>extract</span>().<span class='ident'>unwrap</span>();

    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;Hello {}, I&#39;m Python {}&quot;</span>, <span class='ident'>user</span>, <span class='ident'>version</span>);
}</pre>
</div><h2 id='reexports' class='section-header'><a href="#reexports">Reexports</a></h2>
<table><tr><td><code>pub use self::<a class='mod'
                                            href='./string/index.html'>string</a>::<a class='struct' href='../cpython/struct.PyBytes.html' title='cpython::PyBytes'>PyBytes</a> as PyString;</code></td></tr></table><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='mod' href='argparse/index.html'
                               title='cpython::argparse'>argparse</a></td>
                        <td class='docblock short'>
                             <p>This module contains logic for parsing a python argument list.
See also the macros <code>py_argparse!</code>, <code>py_fn</code> and <code>py_method</code>.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='mod' href='exc/index.html'
                               title='cpython::exc'>exc</a></td>
                        <td class='docblock short'>
                             <p>This module contains the python exception types.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='mod' href='oldstyle/index.html'
                               title='cpython::oldstyle'>oldstyle</a></td>
                        <td class='docblock short'>
                             <p>This module contains support for old-style classes. Only available in Python 2.x.</p>

                        </td>
                    </tr>
                </table><h2 id='macros' class='section-header'><a href="#macros">Macros</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_argparse!.html'
                               title='cpython::py_argparse!'>py_argparse!</a></td>
                        <td class='docblock short'>
                             <p>This macro is used to parse a parameter list into a set of variables.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_class_method!.html'
                               title='cpython::py_class_method!'>py_class_method!</a></td>
                        <td class='docblock short'>
                             <p>Creates a Python class method descriptor that invokes a Rust function.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_fn!.html'
                               title='cpython::py_fn!'>py_fn!</a></td>
                        <td class='docblock short'>
                             <p>Creates a Python callable object that invokes a Rust function.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_method!.html'
                               title='cpython::py_method!'>py_method!</a></td>
                        <td class='docblock short'>
                             <p>Creates a Python instance method descriptor that invokes a Rust function.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_method_call_impl!.html'
                               title='cpython::py_method_call_impl!'>py_method_call_impl!</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='macro' href='macro.py_module_initializer!.html'
                               title='cpython::py_module_initializer!'>py_module_initializer!</a></td>
                        <td class='docblock short'>
                             <p>Expands to an <code>extern &quot;C&quot;</code> function that allows Python to load
the rust code as a Python extension module.</p>

                        </td>
                    </tr>
                </table><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.GILGuard.html'
                               title='cpython::GILGuard'>GILGuard</a></td>
                        <td class='docblock short'>
                             <p>RAII type that represents an acquired GIL.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.GILProtected.html'
                               title='cpython::GILProtected'>GILProtected</a></td>
                        <td class='docblock short'>
                             <p>Mutex-like wrapper object for data that is protected by the Python GIL.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.NoArgs.html'
                               title='cpython::NoArgs'>NoArgs</a></td>
                        <td class='docblock short'>
                             <p>An empty struct that represents the empty argument list.
Corresponds to the empty tuple <code>()</code> in Python.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyBool.html'
                               title='cpython::PyBool'>PyBool</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python <code>bool</code>.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyBytes.html'
                               title='cpython::PyBytes'>PyBytes</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python byte string.
Corresponds to <code>str</code> in Python 2, and <code>bytes</code> in Python 3.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyDict.html'
                               title='cpython::PyDict'>PyDict</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python <code>dict</code>.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyErr.html'
                               title='cpython::PyErr'>PyErr</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python exception that was raised.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyFloat.html'
                               title='cpython::PyFloat'>PyFloat</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python <code>float</code> object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyInt.html'
                               title='cpython::PyInt'>PyInt</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python <code>int</code> object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyIterator.html'
                               title='cpython::PyIterator'>PyIterator</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyList.html'
                               title='cpython::PyList'>PyList</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python <code>list</code>.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyLong.html'
                               title='cpython::PyLong'>PyLong</a></td>
                        <td class='docblock short'>
                             <p>In Python 2.x, represents a Python <code>long</code> object.
In Python 3.x, represents a Python <code>int</code> object.
Both <code>PyInt</code> and <code>PyLong</code> refer to the same type on Python 3.x.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyModule.html'
                               title='cpython::PyModule'>PyModule</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python module object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyObject.html'
                               title='cpython::PyObject'>PyObject</a></td>
                        <td class='docblock short'>
                             <p>Represents a reference to a Python object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyRustObject.html'
                               title='cpython::PyRustObject'>PyRustObject</a></td>
                        <td class='docblock short'>
                             <p>A Python object that contains a rust value of type T,
and is derived from base class B.
Note that this type effectively acts like <code>Rc&lt;T&gt;</code>,
except that the reference counting is done by the Python runtime.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyRustType.html'
                               title='cpython::PyRustType'>PyRustType</a></td>
                        <td class='docblock short'>
                             <p>A Python class that contains rust values of type T.
Serves as a Python type object, and can be used to construct
<code>PyRustObject&lt;T&gt;</code> instances.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyRustTypeBuilder.html'
                               title='cpython::PyRustTypeBuilder'>PyRustTypeBuilder</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyTuple.html'
                               title='cpython::PyTuple'>PyTuple</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python tuple object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyType.html'
                               title='cpython::PyType'>PyType</a></td>
                        <td class='docblock short'>
                             <p>Represents a reference to a Python type object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.PyUnicode.html'
                               title='cpython::PyUnicode'>PyUnicode</a></td>
                        <td class='docblock short'>
                             <p>Represents a Python unicode string.
Corresponds to <code>unicode</code> in Python 2, and <code>str</code> in Python 3.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='struct' href='struct.Python.html'
                               title='cpython::Python'>Python</a></td>
                        <td class='docblock short'>
                             <p>Marker type that indicates that the GIL is currently held.</p>

                        </td>
                    </tr>
                </table><h2 id='traits' class='section-header'><a href="#traits">Traits</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.ExtractPyObject.html'
                               title='cpython::ExtractPyObject'>ExtractPyObject</a></td>
                        <td class='docblock short'>
                             <p>FromPyObject is implemented by various types that can be extracted from a Python object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.ObjectProtocol.html'
                               title='cpython::ObjectProtocol'>ObjectProtocol</a></td>
                        <td class='docblock short'>
                             <p>Trait that contains methods</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.PythonObject.html'
                               title='cpython::PythonObject'>PythonObject</a></td>
                        <td class='docblock short'>
                             <p>Trait implemented by all Python object types.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.PythonObjectWithCheckedDowncast.html'
                               title='cpython::PythonObjectWithCheckedDowncast'>PythonObjectWithCheckedDowncast</a></td>
                        <td class='docblock short'>
                             <p>Trait implemented by Python object types that allow a checked downcast.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.PythonObjectWithTypeObject.html'
                               title='cpython::PythonObjectWithTypeObject'>PythonObjectWithTypeObject</a></td>
                        <td class='docblock short'>
                             <p>Trait implemented by Python object types that have a corresponding type object.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='trait' href='trait.ToPyObject.html'
                               title='cpython::ToPyObject'>ToPyObject</a></td>
                        <td class='docblock short'>
                             <p>Conversion trait that allows various objects to be converted into Python objects.</p>

                        </td>
                    </tr>
                </table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.prepare_freethreaded_python.html'
                               title='cpython::prepare_freethreaded_python'>prepare_freethreaded_python</a></td>
                        <td class='docblock short'>
                             <p>Prepares the use of Python in a free-threaded context.</p>

                        </td>
                    </tr>
                </table><h2 id='types' class='section-header'><a href="#types">Type Definitions</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='type' href='type.PyResult.html'
                               title='cpython::PyResult'>PyResult</a></td>
                        <td class='docblock short'>
                             <p>Represents the result of a Python call.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='type' href='type.Py_hash_t.html'
                               title='cpython::Py_hash_t'>Py_hash_t</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='type' href='type.Py_ssize_t.html'
                               title='cpython::Py_ssize_t'>Py_ssize_t</a></td>
                        <td class='docblock short'>
                             
                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div>
            <div class="shortcuts">
                <h1>Keyboard Shortcuts</h1>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h1>Search Tricks</h1>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </div>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "cpython";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script async src="../search-index.js"></script>
</body>
</html>